/**
 * Policy Registry - File-based policy card storage with signature verification
 *
 * Responsibilities:
 * - Load PolicyCards from .mlang/registry/*.policy.json
 * - Verify Ed25519 signatures using public keys from .mlang/keys/
 * - Manage versions and channels
 * - Support registry operations: register, get, list, verify
 *
 * @since M2 (Team A)
 */
import { type PolicyCard } from '@mdp-framework/schemas/contracts';
/**
 * Registry configuration
 */
export interface RegistryConfig {
    /**
     * Base path to .mlang directory (default: .mlang)
     */
    basePath: string;
    /**
     * Path to public keys directory (default: .mlang/keys)
     */
    keysPath?: string;
    /**
     * Whether to require signatures (default: false for v1)
     */
    requireSignature?: boolean;
    /**
     * Whether to verify hash integrity (default: true)
     */
    verifyHash?: boolean;
}
/**
 * Channel pointer metadata
 */
export interface ChannelPointer {
    id: string;
    channel: 'stable' | 'preview' | 'dev';
    version: string;
    updated_at: string;
}
/**
 * Registry operation result
 */
export interface RegistryResult<T> {
    ok: boolean;
    data?: T;
    error?: {
        code: string;
        message: string;
        details?: unknown;
    };
}
/**
 * PolicyRegistry - File-based registry with signature verification
 */
export declare class PolicyRegistry {
    private config;
    private registryPath;
    private channelsPath;
    private publicKeys;
    constructor(config: RegistryConfig);
    /**
     * Load public keys from .mlang/keys/*.pub
     */
    private loadPublicKeys;
    /**
     * Parse public key from PEM or base64 format
     */
    private parsePublicKey;
    /**
     * Register a policy card
     *
     * @param card - PolicyCard to register
     * @param channel - Channel to associate with (optional)
     * @returns Result of registration
     */
    register(card: PolicyCard, channel?: 'stable' | 'preview' | 'dev'): Promise<RegistryResult<void>>;
    /**
     * Get a policy card by ID and version
     *
     * @param id - Policy ID (e.g., "eng.pr.review")
     * @param version - Optional version (YYYY.MM.DD). If not provided, returns latest.
     * @returns Policy card or error
     */
    get(id: string, version?: string): Promise<RegistryResult<PolicyCard>>;
    /**
     * List all policy IDs in registry
     *
     * @param prefix - Optional prefix filter (e.g., "eng." to get all eng.* policies)
     * @returns List of policy IDs
     */
    list(prefix?: string): Promise<RegistryResult<string[]>>;
    /**
     * Get channel pointer (resolve channel to version)
     *
     * @param id - Policy ID
     * @param channel - Channel name
     * @returns Version for the channel
     */
    getChannel(id: string, channel: 'stable' | 'preview' | 'dev'): Promise<RegistryResult<string>>;
    /**
     * Update channel pointer
     *
     * @param id - Policy ID
     * @param channel - Channel name
     * @param version - Version to point to
     * @returns Result of update
     */
    updateChannel(id: string, channel: 'stable' | 'preview' | 'dev', version: string): Promise<RegistryResult<void>>;
    /**
     * Verify a policy card's signature and hash
     *
     * @param card - Policy card to verify
     * @returns Verification result
     */
    verify(card: PolicyCard): Promise<RegistryResult<{
        hash: boolean;
        signature: boolean;
        signedBy?: string;
    }>>;
    /**
     * Verify hash integrity
     */
    private verifyHash;
    /**
     * Verify Ed25519 signature
     */
    private verifySignature;
    /**
     * Compute SHA-256 hash of content with sha256: prefix
     */
    private computeHash;
    /**
     * List versions for a policy (sorted oldest to newest)
     */
    private listVersions;
}
/**
 * Create a policy registry instance
 *
 * @param basePath - Path to .mlang directory
 * @param config - Optional configuration
 * @returns PolicyRegistry instance
 */
export declare function createRegistry(basePath: string, config?: Partial<RegistryConfig>): PolicyRegistry;
//# sourceMappingURL=registry.d.ts.map