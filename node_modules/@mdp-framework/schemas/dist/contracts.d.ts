/**
 * @mdp-framework/schemas/contracts
 *
 * FROZEN CONTRACT EXPORTS for cross-team coordination.
 *
 * This module provides stable type definitions and schemas for Team A (M2) and Team B (M5)
 * to depend on during parallel development. Changes to these contracts require:
 *
 * 1. Major version bump
 * 2. Cross-team notification
 * 3. Migration guide in CONTRACTS.md
 *
 * Teams MUST NOT import from index.ts directly - use this contracts module instead.
 *
 * @since M1.5 (Contract Hardening)
 */
export interface PolicyCard {
    id: string;
    version: string;
    scope: 'repo' | 'org' | 'team' | 'global';
    role: string;
    title?: string;
    description?: string;
    tags?: string[];
    constraints?: Record<string, unknown>;
    on_violation?: Array<{
        action: 'warn' | 'fail' | 'comment' | 'suggest_patch' | 'notify';
        message?: string;
        metadata?: Record<string, unknown>;
    }>;
    hash: string;
    signature?: string;
    signed_by?: string;
    metadata?: Record<string, unknown>;
    _sourceMarkdown?: string;
    _structuredSections?: {
        purpose?: string;
        detection?: string;
        exceptions?: string;
        examples?: string;
        remediation?: string;
        references?: string;
    };
}
export interface Evidence {
    type: 'file' | 'link' | 'artifact' | 'log' | 'custom';
    ref: string;
    title?: string;
    metadata?: Record<string, unknown>;
}
export interface StateCapsule {
    id: string;
    kind: 'feature' | 'issue' | 'pr' | 'investigation' | 'custom';
    version: number;
    created_at: string;
    updated_at?: string;
    ttl?: number;
    context?: {
        repo?: string;
        branch?: string;
        pr_number?: number;
        issue_key?: string;
        initiator?: string;
        [key: string]: unknown;
    };
    decisions?: Array<{
        question: string;
        answer: string | number | boolean | object | unknown[];
        timestamp: string;
        source?: 'user' | 'agent' | 'system';
    }>;
    evidence?: Evidence[];
    policy_ids?: string[];
    artifacts?: Record<string, {
        content?: string;
        content_type?: string;
        size?: number;
        hash?: string;
    }>;
    metadata?: Record<string, unknown>;
}
export interface Envelope {
    id: string;
    version: 'v1';
    timestamp: string;
    status: 'success' | 'warning' | 'failure' | 'error';
    execution: {
        mode: 'enforce' | 'report' | 'dry-run';
        duration_ms: number;
        host?: string;
        triggered_by?: string;
    };
    capsule_id?: string;
    policy_ids?: string[];
    resolver?: {
        snapshot_time?: string;
        channel?: string;
        degraded?: boolean;
    };
    results?: Array<{
        policy_id: string;
        outcome: 'pass' | 'warn' | 'fail';
        violations?: Array<{
            message?: string;
            location?: {
                file?: string;
                line?: number;
                column?: number;
            };
            severity?: 'info' | 'warning' | 'error';
        }>;
        duration_ms?: number;
    }>;
    evidence_ids?: string[];
    actions?: Array<{
        type: 'comment' | 'check' | 'patch' | 'notify' | 'block';
        status?: 'pending' | 'completed' | 'failed';
        ref?: string;
        metadata?: Record<string, unknown>;
    }>;
    artifacts?: Record<string, {
        type?: string;
        ref?: string;
        hash?: string;
    }>;
    observability?: {
        trace_id?: string;
        span_id?: string;
        events?: Array<{
            timestamp?: string;
            type?: string;
            message?: string;
            metadata?: Record<string, unknown>;
        }>;
    };
    metadata?: Record<string, unknown>;
}
export interface AOISpec {
    id: string;
    kind: 'component' | 'policy' | 'adapter' | 'schema' | 'config' | 'custom';
    name: string;
    description?: string;
    status: 'detected' | 'specified' | 'assigned' | 'stubbed' | 'resolved' | 'migrated';
    created_at: string;
    updated_at?: string;
    detected_in?: {
        repo?: string;
        pr_number?: number;
        file?: string;
        line?: number;
    };
    specification?: {
        interface?: Record<string, unknown>;
        requirements?: string[];
        examples?: Array<{
            description?: string;
            code?: string;
        }>;
    };
    ownership?: {
        team?: string;
        assignee?: string;
        assigned_at?: string;
    };
    tracking?: {
        issue_key?: string;
        issue_url?: string;
        stub_pr?: number;
        stub_pr_url?: string;
        implementation_pr?: number;
        migration_pr?: number;
    };
    sla?: {
        target_date?: string;
        priority?: 'low' | 'medium' | 'high' | 'critical';
        escalated?: boolean;
    };
    metadata?: Record<string, unknown>;
}
/**
 * ActionPlan - Executable actions based on policy evaluation
 *
 * FROZEN VERBS (category.action naming):
 * - gate.ci.warn, gate.ci.block
 * - notify.pr.comment, notify.slack, notify.jira.issue, notify.trace
 * - remediate.suggest.patch, remediate.apply.patch, remediate.open.counter_pr
 * - evidence.attach
 *
 * Adding new verbs requires major version bump and cross-team coordination.
 */
export interface ActionPlan {
    schema_version: 'v1';
    plan_id: string;
    policy_id: string;
    created_at?: string;
    actions: Array<{
        verb: 'gate.ci.warn' | 'gate.ci.block' | 'notify.pr.comment' | 'remediate.suggest.patch' | 'remediate.apply.patch' | 'remediate.open.counter_pr' | 'notify.slack' | 'notify.jira.issue' | 'notify.trace' | 'evidence.attach';
        parameters: Record<string, unknown>;
        condition?: string;
    }>;
    metadata?: {
        triggered_by?: string;
        context?: Record<string, unknown>;
        [key: string]: unknown;
    };
}
export interface ValidationError {
    path: string;
    message: string;
    keyword?: string;
    params?: Record<string, unknown>;
}
export declare const validators: {
    policyCard: {
        validate: (data: unknown) => data is PolicyCard;
        errors: () => ValidationError[];
    };
    stateCapsule: {
        validate: (data: unknown) => data is StateCapsule;
        errors: () => ValidationError[];
    };
    envelope: {
        validate: (data: unknown) => data is Envelope;
        errors: () => ValidationError[];
    };
    aoiSpec: {
        validate: (data: unknown) => data is AOISpec;
        errors: () => ValidationError[];
    };
    actionPlan: {
        validate: (data: unknown) => data is ActionPlan;
        errors: () => ValidationError[];
    };
};
export declare const schemas: {
    policyCard: {
        $schema: string;
        $id: string;
        title: string;
        description: string;
        type: string;
        required: string[];
        properties: {
            id: {
                type: string;
                description: string;
                pattern: string;
            };
            version: {
                type: string;
                description: string;
                pattern: string;
            };
            scope: {
                type: string;
                description: string;
                enum: string[];
            };
            role: {
                type: string;
                description: string;
                pattern: string;
            };
            title: {
                type: string;
                description: string;
            };
            description: {
                type: string;
                description: string;
            };
            tags: {
                type: string;
                description: string;
                items: {
                    type: string;
                };
            };
            constraints: {
                type: string;
                description: string;
                additionalProperties: boolean;
            };
            on_violation: {
                type: string;
                description: string;
                items: {
                    type: string;
                    required: string[];
                    properties: {
                        action: {
                            type: string;
                            enum: string[];
                        };
                        message: {
                            type: string;
                            description: string;
                        };
                        metadata: {
                            type: string;
                            description: string;
                            additionalProperties: boolean;
                        };
                    };
                };
            };
            hash: {
                type: string;
                description: string;
                pattern: string;
            };
            signature: {
                type: string;
                description: string;
            };
            signed_by: {
                type: string;
                description: string;
            };
            aoi: {
                type: string;
                description: string;
                properties: {
                    enabled: {
                        type: string;
                        description: string;
                    };
                    framework: {
                        type: string;
                        description: string;
                    };
                    owners: {
                        type: string;
                        description: string;
                        items: {
                            type: string;
                        };
                    };
                    include_tests: {
                        type: string;
                        description: string;
                        default: boolean;
                    };
                    threshold: {
                        type: string;
                        description: string;
                        minimum: number;
                        maximum: number;
                        default: number;
                    };
                    auto_create_counter_pr: {
                        type: string;
                        description: string;
                        default: boolean;
                    };
                    auto_create_followup_pr: {
                        type: string;
                        description: string;
                        default: boolean;
                    };
                };
            };
            metadata: {
                type: string;
                description: string;
                properties: {
                    author: {
                        type: string;
                    };
                    created_at: {
                        type: string;
                        format: string;
                    };
                    source: {
                        type: string;
                        description: string;
                    };
                };
                additionalProperties: boolean;
            };
        };
    };
    stateCapsule: {
        $schema: string;
        $id: string;
        title: string;
        description: string;
        type: string;
        required: string[];
        properties: {
            id: {
                type: string;
                description: string;
                pattern: string;
            };
            kind: {
                type: string;
                description: string;
                enum: string[];
            };
            version: {
                type: string;
                description: string;
                minimum: number;
            };
            created_at: {
                type: string;
                format: string;
                description: string;
            };
            updated_at: {
                type: string;
                format: string;
                description: string;
            };
            ttl: {
                type: string;
                description: string;
                minimum: number;
            };
            context: {
                type: string;
                description: string;
                properties: {
                    repo: {
                        type: string;
                        description: string;
                    };
                    branch: {
                        type: string;
                    };
                    pr_number: {
                        type: string;
                    };
                    issue_key: {
                        type: string;
                    };
                    initiator: {
                        type: string;
                        description: string;
                    };
                };
                additionalProperties: boolean;
            };
            decisions: {
                type: string;
                description: string;
                items: {
                    type: string;
                    required: string[];
                    properties: {
                        question: {
                            type: string;
                            description: string;
                        };
                        answer: {
                            description: string;
                            oneOf: {
                                type: string;
                            }[];
                        };
                        timestamp: {
                            type: string;
                            format: string;
                        };
                        source: {
                            type: string;
                            enum: string[];
                        };
                    };
                };
            };
            evidence: {
                type: string;
                description: string;
                items: {
                    type: string;
                    description: string;
                };
            };
            policy_ids: {
                type: string;
                description: string;
                items: {
                    type: string;
                    pattern: string;
                };
            };
            artifacts: {
                type: string;
                description: string;
                additionalProperties: {
                    type: string;
                    properties: {
                        content: {
                            type: string;
                        };
                        content_type: {
                            type: string;
                        };
                        size: {
                            type: string;
                        };
                        hash: {
                            type: string;
                        };
                    };
                };
            };
            metadata: {
                type: string;
                description: string;
                additionalProperties: boolean;
            };
        };
    };
    envelope: {
        $schema: string;
        $id: string;
        title: string;
        description: string;
        type: string;
        required: string[];
        properties: {
            id: {
                type: string;
                description: string;
                pattern: string;
            };
            version: {
                type: string;
                description: string;
                const: string;
            };
            timestamp: {
                type: string;
                format: string;
                description: string;
            };
            status: {
                type: string;
                description: string;
                enum: string[];
            };
            execution: {
                type: string;
                description: string;
                required: string[];
                properties: {
                    mode: {
                        type: string;
                        enum: string[];
                    };
                    duration_ms: {
                        type: string;
                        minimum: number;
                    };
                    host: {
                        type: string;
                        description: string;
                    };
                    triggered_by: {
                        type: string;
                        description: string;
                    };
                };
            };
            capsule_id: {
                type: string;
                description: string;
                pattern: string;
            };
            policy_ids: {
                type: string;
                description: string;
                items: {
                    type: string;
                    pattern: string;
                };
            };
            resolver: {
                type: string;
                description: string;
                properties: {
                    snapshot_time: {
                        type: string;
                        format: string;
                        description: string;
                    };
                    channel: {
                        type: string;
                        description: string;
                    };
                    degraded: {
                        type: string;
                        description: string;
                    };
                };
            };
            results: {
                type: string;
                description: string;
                items: {
                    type: string;
                    required: string[];
                    properties: {
                        policy_id: {
                            type: string;
                        };
                        outcome: {
                            type: string;
                            enum: string[];
                        };
                        violations: {
                            type: string;
                            items: {
                                type: string;
                                properties: {
                                    message: {
                                        type: string;
                                    };
                                    location: {
                                        type: string;
                                        properties: {
                                            file: {
                                                type: string;
                                            };
                                            line: {
                                                type: string;
                                            };
                                            column: {
                                                type: string;
                                            };
                                        };
                                    };
                                    severity: {
                                        type: string;
                                        enum: string[];
                                    };
                                };
                            };
                        };
                        duration_ms: {
                            type: string;
                        };
                    };
                };
            };
            evidence_ids: {
                type: string;
                description: string;
                items: {
                    type: string;
                };
            };
            actions: {
                type: string;
                description: string;
                items: {
                    type: string;
                    required: string[];
                    properties: {
                        type: {
                            type: string;
                            enum: string[];
                        };
                        status: {
                            type: string;
                            enum: string[];
                        };
                        ref: {
                            type: string;
                            description: string;
                        };
                        metadata: {
                            type: string;
                            additionalProperties: boolean;
                        };
                    };
                };
            };
            artifacts: {
                type: string;
                description: string;
                additionalProperties: {
                    type: string;
                    properties: {
                        type: {
                            type: string;
                        };
                        ref: {
                            type: string;
                        };
                        hash: {
                            type: string;
                        };
                    };
                };
            };
            observability: {
                type: string;
                description: string;
                properties: {
                    trace_id: {
                        type: string;
                    };
                    span_id: {
                        type: string;
                    };
                    events: {
                        type: string;
                        items: {
                            type: string;
                            properties: {
                                timestamp: {
                                    type: string;
                                    format: string;
                                };
                                type: {
                                    type: string;
                                };
                                message: {
                                    type: string;
                                };
                                metadata: {
                                    type: string;
                                    additionalProperties: boolean;
                                };
                            };
                        };
                    };
                };
            };
            metadata: {
                type: string;
                description: string;
                additionalProperties: boolean;
            };
        };
    };
    aoiSpec: {
        $schema: string;
        $id: string;
        title: string;
        description: string;
        type: string;
        required: string[];
        properties: {
            id: {
                type: string;
                description: string;
                pattern: string;
            };
            kind: {
                type: string;
                description: string;
                enum: string[];
            };
            name: {
                type: string;
                description: string;
            };
            description: {
                type: string;
                description: string;
            };
            status: {
                type: string;
                enum: string[];
                description: string;
            };
            created_at: {
                type: string;
                format: string;
            };
            updated_at: {
                type: string;
                format: string;
            };
            detected_in: {
                type: string;
                description: string;
                properties: {
                    repo: {
                        type: string;
                    };
                    pr_number: {
                        type: string;
                    };
                    file: {
                        type: string;
                    };
                    line: {
                        type: string;
                    };
                };
            };
            specification: {
                type: string;
                description: string;
                properties: {
                    interface: {
                        type: string;
                        description: string;
                        additionalProperties: boolean;
                    };
                    requirements: {
                        type: string;
                        items: {
                            type: string;
                        };
                    };
                    examples: {
                        type: string;
                        items: {
                            type: string;
                            properties: {
                                description: {
                                    type: string;
                                };
                                code: {
                                    type: string;
                                };
                            };
                        };
                    };
                };
            };
            ownership: {
                type: string;
                description: string;
                properties: {
                    team: {
                        type: string;
                    };
                    assignee: {
                        type: string;
                    };
                    assigned_at: {
                        type: string;
                        format: string;
                    };
                };
            };
            tracking: {
                type: string;
                description: string;
                properties: {
                    issue_key: {
                        type: string;
                    };
                    issue_url: {
                        type: string;
                    };
                    stub_pr: {
                        type: string;
                    };
                    stub_pr_url: {
                        type: string;
                    };
                    implementation_pr: {
                        type: string;
                    };
                    migration_pr: {
                        type: string;
                    };
                };
            };
            sla: {
                type: string;
                description: string;
                properties: {
                    target_date: {
                        type: string;
                        format: string;
                    };
                    priority: {
                        type: string;
                        enum: string[];
                    };
                    escalated: {
                        type: string;
                    };
                };
            };
            metadata: {
                type: string;
                additionalProperties: boolean;
            };
        };
    };
    actionPlan: {
        $schema: string;
        $id: string;
        title: string;
        description: string;
        type: string;
        required: string[];
        properties: {
            schema_version: {
                type: string;
                const: string;
                description: string;
            };
            plan_id: {
                type: string;
                pattern: string;
                description: string;
            };
            policy_id: {
                type: string;
                pattern: string;
                description: string;
            };
            created_at: {
                type: string;
                format: string;
                description: string;
            };
            actions: {
                type: string;
                minItems: number;
                description: string;
                items: {
                    type: string;
                    required: string[];
                    properties: {
                        verb: {
                            type: string;
                            enum: string[];
                            description: string;
                        };
                        parameters: {
                            type: string;
                            description: string;
                            additionalProperties: boolean;
                        };
                        condition: {
                            type: string;
                            description: string;
                        };
                    };
                    additionalProperties: boolean;
                };
            };
            metadata: {
                type: string;
                description: string;
                properties: {
                    triggered_by: {
                        type: string;
                        description: string;
                    };
                    context: {
                        type: string;
                        description: string;
                        additionalProperties: boolean;
                    };
                };
                additionalProperties: boolean;
            };
        };
        additionalProperties: boolean;
    };
};
/**
 * Validates that a policy_id is versioned (not a channel)
 *
 * Valid:   eng.security-review@2025.01.10
 * Invalid: eng.latest
 * Invalid: eng.security-review
 */
export declare function isPolicyVersioned(policyId: string): boolean;
/**
 * Validates that all policy_ids in an array are versioned
 * Throws if any channel references are found
 */
export declare function enforceNoChannels(policyIds: string[]): void;
/**
 * Extracts the version date from a versioned policy_id
 * Returns null if policy_id is not versioned
 */
export declare function extractPolicyVersion(policyId: string): string | null;
//# sourceMappingURL=contracts.d.ts.map