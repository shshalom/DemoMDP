{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://mdp.dev/schemas/workflow-result/v1",
  "title": "WorkflowResult",
  "description": "Result of multi-agent workflow execution",
  "type": "object",
  "required": ["capsule_id", "agents_invoked", "handoffs", "final_decisions", "execution_time_ms", "status"],
  "properties": {
    "capsule_id": {
      "type": "string",
      "description": "Updated capsule ID"
    },
    "agents_invoked": {
      "type": "array",
      "description": "Agents invoked in execution order",
      "items": {
        "type": "string"
      }
    },
    "handoffs": {
      "type": "array",
      "description": "All handoffs that occurred",
      "items": {
        "$ref": "https://mdp.dev/schemas/agent-handoff/v1"
      }
    },
    "final_decisions": {
      "type": "array",
      "description": "Aggregated decisions from all agents",
      "items": {
        "type": "object",
        "required": ["question", "answer"],
        "properties": {
          "question": {
            "type": "string"
          },
          "answer": {
            "type": "string"
          },
          "reasoning": {
            "type": "string"
          },
          "confidence": {
            "type": "number",
            "minimum": 0.0,
            "maximum": 1.0
          },
          "agent": {
            "type": "string",
            "description": "Agent that made this decision"
          }
        }
      }
    },
    "execution_time_ms": {
      "type": "integer",
      "description": "Total workflow execution time",
      "minimum": 0
    },
    "status": {
      "type": "string",
      "enum": ["success", "partial", "failed"],
      "description": "Workflow status"
    },
    "error": {
      "type": "object",
      "description": "Error details if failed",
      "properties": {
        "agent": {
          "type": "string",
          "description": "Agent that failed"
        },
        "message": {
          "type": "string"
        },
        "recoverable": {
          "type": "boolean",
          "description": "Can workflow be retried?"
        }
      }
    }
  }
}
