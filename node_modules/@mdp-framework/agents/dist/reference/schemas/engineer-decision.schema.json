{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "https://mdp-framework.dev/schemas/engineer-decision.json",
    "title": "Engineer Decision Schema",
    "description": "Schema for Engineer agent decision output",
    "type": "object",
    "required": ["implementation_assessment", "tasks", "implementation_decisions"],
    "properties": {
        "implementation_assessment": {
            "type": "object",
            "required": ["feasibility", "effort_estimate"],
            "properties": {
                "feasibility": {
                    "type": "string",
                    "enum": ["straightforward", "moderate", "complex", "challenging"],
                    "description": "Implementation feasibility"
                },
                "effort_estimate": {
                    "type": "string",
                    "description": "Estimated effort (e.g., '2-3 days', '4-6 hours')"
                },
                "complexity_factors": {
                    "type": "array",
                    "items": { "type": "string" },
                    "description": "Factors contributing to complexity"
                },
                "recommendations": {
                    "type": "string",
                    "description": "Implementation recommendations"
                }
            }
        },
        "tasks": {
            "type": "array",
            "description": "Implementation task breakdown",
            "items": {
                "type": "object",
                "required": ["id", "title", "description", "component"],
                "properties": {
                    "id": {
                        "type": "string",
                        "pattern": "^TASK-[0-9]+$",
                        "description": "Task identifier"
                    },
                    "title": {
                        "type": "string",
                        "minLength": 5,
                        "description": "Task title"
                    },
                    "description": {
                        "type": "string",
                        "minLength": 10,
                        "description": "Detailed task description"
                    },
                    "component": {
                        "type": "string",
                        "description": "Component this task relates to"
                    },
                    "effort_estimate": {
                        "type": "string",
                        "description": "Effort estimate for this task"
                    },
                    "dependencies": {
                        "type": "array",
                        "items": { "type": "string" },
                        "description": "Task dependencies"
                    },
                    "priority": {
                        "type": "string",
                        "enum": ["high", "medium", "low"],
                        "description": "Task priority"
                    }
                }
            },
            "minItems": 1
        },
        "implementation_decisions": {
            "type": "array",
            "description": "Implementation-level decisions",
            "items": {
                "type": "object",
                "required": ["question", "answer", "reasoning"],
                "properties": {
                    "question": {
                        "type": "string",
                        "minLength": 10,
                        "description": "Decision question"
                    },
                    "answer": {
                        "type": "string",
                        "minLength": 10,
                        "description": "Implementation decision"
                    },
                    "reasoning": {
                        "type": "string",
                        "minLength": 20,
                        "description": "Technical reasoning"
                    },
                    "code_example": {
                        "type": "string",
                        "description": "Brief code example"
                    },
                    "confidence": {
                        "type": "number",
                        "minimum": 0,
                        "maximum": 1,
                        "description": "Confidence level"
                    }
                }
            },
            "minItems": 1
        },
        "code_structure": {
            "type": "array",
            "description": "Code file structure",
            "items": {
                "type": "object",
                "required": ["file_path", "purpose", "type"],
                "properties": {
                    "file_path": {
                        "type": "string",
                        "description": "File path"
                    },
                    "purpose": {
                        "type": "string",
                        "description": "File purpose"
                    },
                    "type": {
                        "type": "string",
                        "enum": ["create", "modify"],
                        "description": "Operation type"
                    },
                    "interfaces": {
                        "type": "array",
                        "items": { "type": "string" },
                        "description": "Key interfaces/types"
                    },
                    "dependencies": {
                        "type": "array",
                        "items": { "type": "string" },
                        "description": "File dependencies"
                    }
                }
            }
        },
        "testing_strategy": {
            "type": "object",
            "properties": {
                "unit_tests": {
                    "type": "array",
                    "items": { "type": "string" },
                    "description": "Unit test cases"
                },
                "integration_tests": {
                    "type": "array",
                    "items": { "type": "string" },
                    "description": "Integration test scenarios"
                },
                "test_coverage_target": {
                    "type": "string",
                    "description": "Target test coverage percentage"
                },
                "testing_notes": {
                    "type": "string",
                    "description": "Special testing considerations"
                }
            }
        },
        "risks": {
            "type": "array",
            "description": "Implementation risks",
            "items": {
                "type": "object",
                "required": ["category", "severity", "description"],
                "properties": {
                    "category": {
                        "type": "string",
                        "enum": ["complexity", "unknown", "performance", "testing"],
                        "description": "Risk category"
                    },
                    "severity": {
                        "type": "string",
                        "enum": ["high", "medium", "low"],
                        "description": "Risk severity"
                    },
                    "description": {
                        "type": "string",
                        "description": "Risk description"
                    },
                    "mitigation": {
                        "type": "string",
                        "description": "Mitigation approach"
                    }
                }
            }
        },
        "technical_notes": {
            "type": "array",
            "items": { "type": "string" },
            "description": "Important technical considerations"
        },
        "next_steps": {
            "type": "array",
            "items": { "type": "string" },
            "description": "Immediate next actions"
        }
    }
}
