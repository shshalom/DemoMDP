/**
 * Policy Parser - Extract frontmatter from Markdown policy files
 *
 * Reads .md files from policies directory and parses YAML frontmatter
 * into PolicyCard structure for compilation.
 */
import type { PolicyCard } from '@mdp-framework/schemas/contracts';
export interface ParsedPolicy {
    /** Parsed policy card (unsigned) */
    card: Omit<PolicyCard, 'hash' | 'signature'>;
    /** Original markdown body (for docs) */
    body: string;
    /** Source file path */
    sourcePath: string;
    /** Structured sections extracted from markdown */
    structuredSections?: {
        purpose?: string;
        detection?: string;
        exceptions?: string;
        examples?: string;
        remediation?: string;
        references?: string;
    };
}
export interface ParseError {
    file: string;
    error: string;
    line?: number;
}
export interface ParseResult {
    policies: ParsedPolicy[];
    errors: ParseError[];
}
/**
 * Parse all policy files in a directory
 */
export declare function parsePolicyDir(dir: string): Promise<ParseResult>;
/**
 * Extract structured sections from markdown body
 * Looks for pattern: ## SectionName\n---\ncontent\n---
 */
export declare function extractStructuredSections(body: string): {
    purpose?: string;
    detection?: string;
    exceptions?: string;
    examples?: string;
    remediation?: string;
    references?: string;
} | undefined;
/**
 * Parse a single policy file
 */
export declare function parsePolicyFile(filePath: string): Promise<ParsedPolicy>;
/**
 * Validate constraint types (loose validation for v1)
 */
export declare function validateConstraints(constraints: Record<string, unknown>): string[];
/**
 * Check if policy card would be oversized when serialized
 */
export declare function checkPolicySize(card: Omit<PolicyCard, 'hash' | 'signature'>): {
    ok: boolean;
    size: number;
};
//# sourceMappingURL=parser.d.ts.map