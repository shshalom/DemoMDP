/**
 * Violation Schema (Stream 2)
 *
 * JSON Schema for structured LLM output when evaluating policies.
 * This ensures the AI returns violations in a consistent, parseable format.
 */
/**
 * Schema for LLM-generated violation detection
 */
export const ViolationSchema = {
    type: 'object',
    properties: {
        violations: {
            type: 'array',
            items: {
                type: 'object',
                properties: {
                    message: {
                        type: 'string',
                        description: 'Clear, actionable message describing the violation',
                    },
                    severity: {
                        type: 'string',
                        enum: ['info', 'warning', 'error'],
                        description: 'Severity level based on policy requirements',
                    },
                    location: {
                        type: 'object',
                        properties: {
                            file: {
                                type: 'string',
                                description: 'File path where violation was found',
                            },
                            line: {
                                type: 'number',
                                description: 'Line number (1-indexed)',
                            },
                            column: {
                                type: 'number',
                                description: 'Column number (1-indexed)',
                            },
                        },
                        required: ['file'],
                    },
                    suggestedFix: {
                        type: 'string',
                        description: 'Suggested fix or remediation guidance',
                    },
                    confidence: {
                        type: 'number',
                        minimum: 0.0,
                        maximum: 1.0,
                        description: 'Confidence score (0.0-1.0) - use 0.9+ for clear violations, 0.5-0.7 for uncertain ones',
                    },
                    reasoning: {
                        type: 'string',
                        description: 'Brief explanation of why this is a violation',
                    },
                },
                required: ['message', 'severity', 'confidence'],
            },
        },
        overall_assessment: {
            type: 'string',
            description: 'Brief summary of the evaluation (1-2 sentences)',
        },
    },
    required: ['violations'],
};
//# sourceMappingURL=violation-schema.js.map